Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/data_log2_kmeans4_knn4_rowscale.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
plot(gs_exp, fontsize = 8, classes = "Groups")
data.all=cbind(ctrls, ps,vi)
summary(data.all)
data.log=log2(data.all)
data.pca=data.log
pheatmap(data.pca, cluster_rows = F, cluster_cols = F,scale = "row", main="All data scaled, contains NA",
filename="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log_NAs.png")
write.table(data.pca,file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_all_log2_with_NA.txt",sep="\t",row.names=T,quote=FALSE)
data.pca1=data.pca[,! apply( data.pca , 2 , function(x) all(is.na(x)) ) ]#removes columns with complete NAs
pheatmap(data.pca1, cluster_rows = F, cluster_cols = F,scale = "row", main="data")#data.pca=data.pca[!rowSums(!is.finite(data.pca)),]#remove nas
numNAs <- apply(data.pca1, 1, function(z) sum(is.na(z)))
data.pca.new=data.pca1[!(numNAs > 0.5*length(colnames(data.pca1))),]
pheatmap(data.pca.new, cluster_rows = F, cluster_cols = F, scale = "row", main="data")
dim(data.pca.new)
#remove cols with more than 50% NAs
data.pca=t(data.pca.new)
numNAs <- apply(data.pca, 1, function(z) sum(is.na(z)))
data.pca.new=data.pca[!(numNAs >0.5*length(colnames(data.pca))),]#previously it was 9
data.pca=t(data.pca.new)
pheatmap(data.pca, cluster_rows = T, cluster_cols = F,scale = "row",main="All data scaled, contains NA",
filename="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log_filt_NAs.png")
dim(data.pca)#35 118
data_log2_filt=data.pca
save(data_log2_filt, file = "~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_filt.RData")
pheatmap(data.pca, cluster_rows = F, cluster_cols = F,scale = "row",main="All data scaled, contains NA",
filename="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log_filt_NAs.png")
library(impute)
library(RColorBrewer)
data=data.pca
data.pca.imp=impute.knn(data ,k = 4, rowmax = 0.5, colmax = 0.8, maxp = 1500, rng.seed=362436069)
data.pca.imp=as.data.frame(data.pca.imp$data)
pheatmap(data.pca.imp, cluster_rows = T, cluster_cols = F,clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",clustering_method = "complete",color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdYlBu")))(250), scale="row",
main="Filtered data after imputation. KNN, k=4", filename="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/filtered_imputed_knn4.png")
pheatmap(data.pca.imp, cluster_rows = F, cluster_cols = F,clustering_distance_rows = "correlation",
pheatmap(data.pca.imp, cluster_rows = T, cluster_cols = F,clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",clustering_method = "complete",color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdYlBu")))(250), scale="row",
library(amap)
hc.data=hcluster(data.pca.imp, method = "correlation", diag = FALSE, upper = FALSE,
link = "complete", members = NULL, nbproc = 2,
doubleprecision = TRUE)
plot(hc.data)
ct=cutree(hc.data, k=5)
sort(ct)
hc.cl.1=as.character(names(sort(ct[ct==1])))
hc.cl.2=as.character(names(sort(ct[ct==2])))
hc.cl.3=as.character(names(sort(ct[ct==3])))
hc.cl.4=as.character(names(sort(ct[ct==4])))
hc.cl.5=as.character(names(sort(ct[ct==5])))
#GO summaries for HC
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
g1=hc.cl.1
g2=hc.cl.2
g3=hc.cl.3
g4=hc.cl.4
g5=hc.cl.5
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
setwd("~/Documents/KAI/cytoskin/after_filt/17112014/noscale/")
plot(gs_exp, fontsize = 8, classes = "Groups", filename = "Gosummaries_data_log2_knn4_hc.pdf")
save(ct,hc, file = "~/Documents/KAI/cytoskin/after_filt/17112014/noscale/hc.RData")
mydata= data.pca.imp
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
library(amap)
s=set.seed(1234)
km=Kmeans(data.pca.imp,5,iter.max = 100500, nstart =500,
method = "correlation")
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_kmeans4_knn4.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
s=set.seed(1234)
km=Kmeans(data.pca.imp,5,iter.max = 100500, nstart =100,
method = "correlation")
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_kmeans4_knn4.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
ct
sor(ct)
sort(ct)
hc.cl.1
km
str(km)
sort(km$cluster)
sort(ct)
km=Kmeans(data.pca.imp,5,iter.max = 100500, nstart =100,
method = "correlation")
sort(km$cluster)
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_kmeans4_knn4.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
plot(hc.data)
ct=cutree(hc.data, k=6)
sort(ct)
hc.cl.1=as.character(names(sort(ct[ct==1])))
hc.cl.2=as.character(names(sort(ct[ct==2])))
hc.cl.3=as.character(names(sort(ct[ct==3])))
hc.cl.4=as.character(names(sort(ct[ct==4])))
hc.cl.5=as.character(names(sort(ct[ct==5])))
hc.cl.6=as.character(names(sort(ct[ct==6])))
g1=hc.cl.1
g2=hc.cl.2
g3=hc.cl.3
g4=hc.cl.4
g5=hc.cl.5
g6=hc.cl.6
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
s=set.seed(12345)
km=Kmeans(data.pca.imp,6,iter.max = 100500, nstart =100,
method = "correlation")
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
plot(gs_exp, fontsize = 8, classes = "Groups")
mydata= data.pca.imp
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
library(amap)
s=set.seed(12345)
km=Kmeans(data.pca.imp,5,iter.max = 100500, nstart =100,
method = "correlation")
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_kmeans4_knn4.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
plot(gs_exp, fontsize = 8, classes = "Groups")
##end go summaries
library(amap)
s=set.seed(1234)
km=Kmeans(data.pca.imp,5,iter.max = 100500, nstart =50,
method = "correlation")
head(km)
data_clust <- cbind(data.pca.imp,km$cluster)#add column cluster number
o<- order(data_clust[,119])###sort by cluster number
data_clust <- data_clust[o, ]###sort by cluster number
head(data_clust)
data_km=data_clust
library(pheatmap)
library(plyr)
colnames(data_clust)[119]="Cluster"###add column name
#Go summaries
library(stringr)
Groups=colnames(data_clust)
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
annotation=cbind(Groups,Groups )
rownames(annotation)=colnames(data_clust)
annot=as.data.frame(annotation[1:118,1])
colnames(annot)="Groups"
Groups=Groups[1:118]
data_clust=data_clust[,1:118]
#colnames(data_clust)=Groups
head(data_clust)
write.table(file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_kmeans4_knn4.txt",data_km, sep="\t", quote=F )
library(GOsummaries)
#gs_kmeans = gosummaries(km, components = 1:2, exp = data_clust, annotation = annotation)
#plot(gs_kmeans, fontsize = 8, classes = "Groups", filename = "figure3.pdf")
list=sort(km$cluster)
g1=names(list[list==1])
g2=names(list[list==2])
g3=names(list[list==3])
g4=names(list[list==4])
g5=names(list[list==5])
#g6=names(list[list==6])
gl=list(Cluster1 = g1, Cluster2 = g2, Cluster3 = g3, Cluster4 = g4, Cluster5 = g5)#, Cluster6 = g6)
gs = gosummaries(gl)
plot(gs, fontsize = 8)
gs_exp = add_expression.gosummaries(gs, exp = data_clust,
annotation = annot)
plot(gs_exp, fontsize = 8, classes = "Groups")
save(km, file = "~/Documents/KAI/cytoskin/after_filt/17112014/noscale/km5.RData")
sort(km$cluster)
data.pca.knn=data.pca.imp
#data.pca=data.pca.new
data.pca.knn=t(data.pca.knn)
pca.all=prcomp(data.pca.knn, scale=T, center=T)#, na.action=na.omit)
#pca.all=prcomp(~., data=data.pca, scale=T, center=T, na.action=na.omit)
summary(pca.all)
library(ggplot2)
library(stringr)
library(gridBase)
library(gridExtra)
Groups=rownames(na.omit(data.pca.knn))
Groups=str_replace(Groups,"C.*","C")
Groups=str_replace(Groups,"PH.*","PH")
Groups=str_replace(Groups,"PT.*","PT")
Groups=str_replace(Groups,"VH.*","VH")
Groups=str_replace(Groups,"VT.*","VT")
Samples=rownames(na.omit(data.pca.knn))
a=qplot(pca.all$x[,1],pca.all$x[,2],xlab="Principal Component 1",ylab= "Principal Component 2",  colour = Groups, label=Samples)+scale_colour_manual(values=c("black","darkblue","seagreen3","red","darkorchid1"))
a1=a+geom_text(size=3,hjust=0.1,vjust=1.6,position = "identity") + theme(legend.position="none")
b=qplot(pca.all$x[,1],pca.all$x[,3],xlab="Principal Component 1",ylab= "Principal Component 3",   colour = Groups, label=Samples)+scale_colour_manual(values=c("black","darkblue","seagreen3","red","darkorchid1"))
b1=b+geom_text(size=3,hjust=0.1,vjust=1.6,position = "identity") + theme(legend.position="none")
c=qplot(pca.all$x[,2],pca.all$x[,3],xlab="Principal Component 2",ylab= "Principal Component 3",  colour = Groups, label=Samples) +scale_colour_manual(values=c("black","darkblue","seagreen3","red","darkorchid1"))
c1=c+geom_text(size=3,hjust=0.1,vjust=1.6,position = "identity") + theme(legend.position="none")
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
legend
}
legend <- g_legend(a)
grid.arrange(a1,b1,c1, legend,
ncol=2, nrow=2, widths=c(1/2,1/2))
save(pca.all,Groups,Samples,file="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/pca.RData")
load("~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_filt.RData")
rm(data_log2_filt)
load("~/Documents/KAI/cytoskin/after_filt/17112014/noscale/data_log2_filt.RData")
View(data_log2_filt)
data_filt=data_log2_filt
ctrls=data_filt[,1:24]
##PSO.h
ph=data_filt[,25:56]
##PSO.t
pt=data_filt[,57:87]
##VIT.h
vh=data_filt[,88:103]
##VIT.t
vt=data_filt[,104:118]
View(ctrls)
View(pso.h)
View(pt)
View(vt)
data=cbind(ctrls,ph,pt,vh,vt)
pheatmap(data, cluster_rows = F, cluster_cols = F, scale = "row", main="All data after standardization")
summary(data)
dim(data)
library(pheatmap)
setwd("~/Documents/KAI/cytoskin/after_filt/17112014/noscale/")
p.test=data[,25:87]
p=p.test
cols=colnames(p)
colnames(p)=cols
#rownames(p)=rows
attribute=colnames(p)
attribute=str_replace(attribute,"0.*","")
coldata=colnames(p)
coldata=str_replace(coldata,"0.*","")
attribute = factor(attribute)
attribute2 = rep("Muu", length(attribute))
# Case-control variables and corresponding group values
case.vals=c("PH")
cont.vals =c("PT")
attribute2[attribute %in% c(case.vals)] = "Group1"
attribute2[attribute %in% c(cont.vals)] = "Group2"
attribute = factor(attribute2)
colnames(p)=coldata
head(p)
mm = model.matrix(~ attribute - 1)
colnames(mm) = make.names(colnames(mm))
colnames(mm)
contrast = makeContrasts(attributeGroup2 - attributeGroup1, levels = colnames(mm))
fit = lmFit(p, mm)
fit = contrasts.fit(fit, contrast)
fit = eBayes(fit)
adj.method="fdr"
thr.p.value=0.05
thr.lfc=1
tt = topTable(fit, coef = 1, p.value = thr.p.value, lfc = thr.lfc, adjust.method = adj.method, number = 10000000)
print(thr.p.value)
tt
ph_pt=tt
genes=rownames(ph_pt)
ph_pt_heatm=p[rownames(p)%in%genes,]
colnames(ph_pt_heatm)=cols
ph_pt_heatm=ph_pt_heatm[ , ! apply( ph_pt_heatm , 2 , function(x) all(is.na(x)) ) ]#removes columns with complete NAs
pheatmap(ph_pt_heatm, cluster_rows = T, cluster_cols = F, scale = "row", main="Psoriasis.Differentially expressed in PHvsPT")
pheatmap(ph_pt_heatm, cluster_rows = T, cluster_cols = F, scale = "row", main="Psoriasis.Differentially expressed in PHvsPT")
library("limma")
library(stringr)
library(pheatmap)
cols
ph_pt_heatm
pheatmap(ph_pt_heatm, cluster_rows = T, cluster_cols = F, scale = "row", main="Psoriasis.Differentially expressed in PHvsPT")
pheatmap(data.pca.imp, cluster_rows = T, cluster_cols = F,clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",clustering_method = "complete",color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdYlBu")))(250), scale="row",
main="Filtered data after imputation. KNN, k=4", filename="~/Documents/KAI/cytoskin/after_filt/17112014/noscale/filtered_imputed_knn4.png")
pheatmap(data, cluster_rows = F, cluster_cols = F, scale = "row", main="All data after standardization")
library(pheatmap)
pheatmap(data, cluster_rows = F, cluster_cols = F, scale = "row", main="All data after standardization")
