levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
cont.dif <- makeContrasts(
#DifII_I =(PH.II-PT.II)-(PH.I-PT.I),
DifIII_II=(PH.III-PT.III)-(PH.II-PT.II),
# DiffIII_I=(PH.III-PT.III)-(PH.I-PT.I),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
tt = topTable(fit2, coef = 1, p.value = 0.05, lfc = 1, adjust.method ="fdr", number = 10000000)####no diff expressed genes
cont.dif <- makeContrasts(
#DifII_I =(PH.II-PT.II)-(PH.I-PT.I),
#DifIII_II=(PH.III-PT.III)-(PH.II-PT.II),
DiffIII_I=(PH.III-PT.III)-(PH.I-PT.I),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
tt = topTable(fit2, coef = 1, p.value = 0.05, lfc = 1, adjust.method ="fdr", number = 10000000)####no diff expressed genes
tt
contrast = makeContrasts(PHvsPTinIII=PH.III-PT.III, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
tt = topTable(fit2, coef = 1, p.value = 0.05, lfc = 1, adjust.method ="fdr", number = 10000000)
tt
topTableF(fit2, adjust="fdr")
#Test skin phototype influence
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Skin_phototype")]
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Skin_phototype")]
rownames(annotationh)=str_replace(rownames(annotation),"P","PH")
rownames(annotationt)=str_replace(rownames(annotation),"P","PT")
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Skin_phototype, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
#colnames(design) <- levels(pheno)
fit <- lmFit(p, design)
#1. Type I
contrast = makeContrasts(PHvsPTinI=PH.I-PT.I, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
p.test=data[,26:94]
p=p.test
cols=colnames(p)
colnames(p)=cols
#Test skin phototype influence
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Skin_phototype")]
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Skin_phototype")]
rownames(annotationh)=str_replace(rownames(annotation),"P","PH")
rownames(annotationt)=str_replace(rownames(annotation),"P","PT")
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Skin_phototype, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
#colnames(design) <- levels(pheno)
fit <- lmFit(p, design)
#1. Type I
contrast = makeContrasts(PHvsPTinI=PH.I-PT.I, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr")
tt = topTable(fit2, coef = 1, p.value = 0.05, lfc = 1, adjust.method ="fdr", number = 10000000) ##no diff expressed genes
tt
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinII=PH.II-PT.II, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr",p.value = 0.05 )
contrast = makeContrasts(PHvsPTinIII=PH.III-PT.III, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Age")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h[annotation.h[,2]>=40, 2]<-"old"
annotation.h[annotation.h[,2]< 40,2]<-"young"
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Age")]
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.t[annotation.t[,2]>=40, 2]<-"old"
annotation.t[annotation.t[,2]<40, 2]<-"young"
rownames(annotationh)=str_replace(rownames(annotation),"P","PH")
rownames(annotationt)=str_replace(rownames(annotation),"P","PT")
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Age, sep=".")
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
contrast = makeContrasts(PHvsPTinyoung=PH.young-PT.young, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinold=PH.old-PT.old, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difold_young =(PH.old-PT.old)-(PH.young-PT.young),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Psoriasis_in_family")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.h[,2]=str_replace(annotation.h[,2],"a.*","yes")
annotation.h
annotation.h[,2]=str_replace(annotation.h[,2],"f.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"s.*","yes")
annotation.h
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h[,2]=str_replace(annotation.h[,2],"a.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"s.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"f.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"m.*","yes")
annotation.h
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Psoriasis_in_family")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.h[,2]=str_replace(annotation.h[,2],"au.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"si.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"fa.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"mo.*","yes")
annotation.h
annotation.h[,2]=str_replace(annotation.h[,2],"so.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"bro.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"chi.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"2_.*","yes")
annotation.h
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Psoriasis_in_family")]
annotation.h[,2]=str_replace(annotation.h[,2],"au.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"si.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"fa.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"mo.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"so.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"bro.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"chi.*","yes")
annotation.h[,2]=str_replace(annotation.h[,2],"2_.*","yes")
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Psoriasis_in_family")]
annotation.t[,2]=str_replace(annotation.t[,2],"au.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"si.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"fa.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"mo.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"so.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"bro.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"chi.*","yes")
annotation.t[,2]=str_replace(annotation.t[,2],"2_.*","yes")
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.t
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
annotation.pso.h.t
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Age, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
targets=data.frame(annotation.pso.h.t[,c(1,3)])
targets
pheno=paste(targets$Sample, targets$Psoriasis_in_family, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
colnames(contarst)
design
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit <- lmFit(p, design)
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinYES=PH.yes-PT.yes, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difold_young =(PH.yes-PT.yes)-(PH.no-PT.no),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difyes_no =(PH.yes-PT.yes)-(PH.no-PT.no),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
View(annotation)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Psoriatic_artritis")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Psoriatic_artritis")]
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Psoriatic_arthritis")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Psoriatic_arthritis")]
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
annotation.pso.h.t
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Psoriasis_in_family, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
design
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Psoriatic_arthritis, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
#1.No psoriatic arthritis in the family
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinYES=PH.yes-PT.yes, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difyes_no =(PH.yes-PT.yes)-(PH.no-PT.no),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
View(annotation)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Age_of_disease_onset")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h[annotation.h[,2]>=40, 2]<-"old"
annotation.h[annotation.h[,2]< 40,2]<-"young"
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Age_of_disease_onset")]
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.t[annotation.t[,2]>=40, 2]<-"old"
annotation.t[annotation.t[,2]<40, 2]<-"young"
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
annotation.pso.h.t
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Age_of_disease_onset, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
#1. Young
contrast = makeContrasts(PHvsPTinyoung=PH.young-PT.young, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinold=PH.old-PT.old, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difold_young =(PH.old-PT.old)-(PH.young-PT.young),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
View(annotation)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","Nail_involvment")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","Nail_involvment")]
annotation.t=annotation.t[order(annotation.t[,2]),]
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Psoriatic_arthritis, sep=".")
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
design
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Nail_involvment, sep=".")
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
fit <- lmFit(p, design)
contrast = makeContrasts(PHvsPTinNO=PH.no-PT.no, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTinYES=PH.yes-PT.yes, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
cont.dif <- makeContrasts(
Difyes_no =(PH.yes-PT.yes)-(PH.no-PT.no),
levels=design)
fit2 <- contrasts.fit(fit, cont.dif)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
View(annotation)
annotation.h[annotation.h[,2]>20, 2]<-"20"
annotation.h[annotation.h[,2]<10,2]<-"10"
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h[annotation.h[,2]>20, 2]<-"20"
annotation.h[annotation.h[,2]<10,2]<-"10"
annotation.h
annotation.h[annotation.h[,2]< 10,2]<-"10"
annotation.h
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.h[annotation.h[,2]< 10, 2]<-"10"
annotation.h
annotation.h[annotation.h[,2]<10, 2]<-"10"
annotation.h
annotation.h[annotation.h[,2]>20, 2]<-"20"
annotation.h
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h=annotation.h[order(annotation.h[,2]),]
annotation.h
annotation.h[,2]=as.numeric(annotation.h[,2])
annotation.h[,2]=as.numeric(annotation.h[,2])
annotation.h[,2]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h[annotation.h[,2]>20, 2]<-"20"
annotation.h[annotation.h[,2]<10, 2]<-"10"
annotation.h[
]
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h[,2]
annotation.h[annotation.h[,2]<10, 2]<-"10"
annotation.h
annotation.h[,2]=as.numeric(annotation.h[,2])
annotation.h[annotation.h[,2]<10, 2]<-"10"
annotation.h
annotation.h[,2]=as.numeric(annotation.h[,2])
str(annotation.h)
transform(annotation.h, PASI_(activity_score = as.numeric(PASI_(activity_score))
)
)
transform(annotation.h, PASI_(activity_score) = as.numeric(PASI_(activity_score)))
transform(annotation.h, PASI_(activity_score)=as.numeric(PASI_(activity_score)))
transform(annotation.h, annotation.h[,2]=as.numeric(annotation.h[,2]))
s.numeric(annotation.h[,2])
as.numeric(annotation.h[,2])
annotation.h[,2]=as.numeric(annotation.h[,2])
annotation.h[,2]
annotation.h[annotation.h[,2]<10, 2]<-"10"
annotation.h
annotation.h[annotation.h[,2]<10, 2]
annotation.h[,2]<10
annotation.h[,2]
str(annotation.h[,2])
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=as.numeric(annotation.h[,2])
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
View(annotation)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h
annotation.h[,2]=as.numeric(annotation.h[,2])
str(annotation.h)
annotation.h=data.frame(annotation.h)
annotation.h[,2]=as.numeri(annotation.h[,2])
annotation.h[,2]=as.numeric(annotation.h[,2])
str(annotation.h)
View(annotation.h)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
View(annotation.h)
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h=data.frame(annotation.h)
View(annotation.h)
annotation.h[,2]=as.numeric(annotation.h[,2])
View(annotation.h)
?as.numeric
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h=data.frame(annotation.h)
annotation.h[,2]=as.numeric(annotation.h[,2], length = 2)
View(annotation.h)
annotation.h[,2]
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h=data.frame(annotation.h)
annotation.h[,2]
as.vector(annotation.h[,2])
as.numeric(as.vector(annotation.h[,2]))
annotation.h[,2]=as.numeric(as.vector(annotation.h[,2]))
annotation.h[annotation.h[,2]>20, 2]<-"20"
?cut
cut(annotation.h[,2], c(10, 20))
annotation.h[,2]
annotation.h[,2]=as.numeric(as.vector(annotation.h[,2]))
cut(annotation.h[,2], c(10, 20))
cut(annotation.h[,2], c(0, 10, 20, Inf))
annotation.h[,2]=cut(annotation.h[,2], c(0, 10, 20, Inf))
View(annotation.h)
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","PASI_(activity_score)")]
annotation.t[,2]=str_replace(annotation.t[,2],",",".")
annotation.t=data.frame(annotation.t)
annotation.t[,2]=as.numeric(as.vector(annotation.t[,2]))
annotation.h[,2]=cut(annotation.h[,2], c(0, 10, 20, Inf))
View(annotation.t)
str(annotation.t)
annotation.t[,2]
annotation.h[,2]=cut(annotation.h[,2], c(0, 10, 20, Inf))
cut(annotation.h[,2], c(0, 10, 20, Inf))
str(annotation.t[,2])
annotation.t[,2]=cut(annotation.t[,2], c(0, 10, 20, Inf))
annotation.pso.h.t=rbind(annotation.h, annotation.t)
annotation.h=annotationh[rownames(annotationh)%in%colnames(p)[1:34],colnames(annotationh)%in%c("Gender","PASI_(activity_score)")]
annotation.h[,2]=str_replace(annotation.h[,2],",",".")
annotation.h=data.frame(annotation.h)
annotation.h[,2]=as.numeric(as.vector(annotation.h[,2]))
annotation.h[,2]=cut(annotation.h[,2], c(0, 10, 20, Inf))
annotation.t=annotationt[rownames(annotationt)%in%colnames(p)[35:69],colnames(annotationt)%in%c("Gender","PASI_(activity_score)")]
annotation.t[,2]=str_replace(annotation.t[,2],",",".")
annotation.t=data.frame(annotation.t)
annotation.t[,2]=as.numeric(as.vector(annotation.t[,2]))
annotation.t[,2]=cut(annotation.t[,2], c(0, 10, 20, Inf))
annotation.pso.h.t=rbind(annotation.h, annotation.t)
Sample=rownames(annotation.pso.h.t)
Sample=str_replace(Sample,"0.*","")
annotation.pso.h.t=cbind(Sample,annotation.pso.h.t)
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$Age_of_disease_onset, sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
design
targets=data.frame(annotation.pso.h.t[,c(1,3)])
pheno=paste(targets$Sample, targets$PASI_(activity_score), sep=".")
#pheno=factor(pheno, levels=pheno)
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
targets=data.frame(annotation.pso.h.t[,c(1,3)])
targets
pheno=paste(targets$Sample, targets$PASI_.activity_score., sep=".")
design <- model.matrix(~0 +pheno)
colnames(design)
colnames(design)=str_replace(colnames(design),"pheno","")
design
contrast = makeContrasts(PHvsPTinI=010=PH.(0,10]-PT.(0,10], levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
contrast = makeContrasts(PHvsPTin010=PH.(0,10]-PT.(0,10], levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
colnames(design)
colnames(design)=c("PH.(0,10]","PH.(10,20]","PH.(20,Inf]","PT.(0,10]","PT.(10,20]","PT.(20,Inf]")
fit <- lmFit(p, design)
colnames(design)=c("PH.10","PH.10.20","PH.20","PT.10","PT.10.20","PT.20")
fit <- lmFit(p, design)
contrast = makeContrasts(PHvsPTin010=PH.10-PT.10, levels=colnames(design))
fit2 <- contrasts.fit(fit, contrast)
fit2 <- eBayes(fit2)
topTableF(fit2, adjust="fdr", p.value = 0.05)
